<?xml version="1.0" encoding="UTF-8"?>
<Window>
	<Sheet>
		<Name>Step 1</Name>
		<Pane>
			<ChartID>1364</ChartID>
			<PercentHeight>50</PercentHeight>
			<Formula>_SECTION_BEGIN("Price");\r\nSetChartOptions(0,chartShowArrows|chartShowDates);\r\n_N(Title = StrFormat("{{NAME}} - {{INTERVAL}} {{DATE}} {{OHLCX}} Vol %.0f {{VALUES}}", V ));\r\nPlot( C, "Close", ParamColor("Color", colorDefault ), styleNoTitle | ParamStyle("Style") | GetPriceStyle() ); \r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("MA");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 15, 2, 200, 1 );\r\nPlot( MA( P, Periods ), _DEFAULT_NAME(), ParamColor( "Color", colorCycle ), ParamStyle("Style", styleLine | styleNoLabel ) | styleNoRescale ); \r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("Mid MA");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 45, 2, 300, 1 );\r\nPlot( MA( P, Periods ), _DEFAULT_NAME(), ParamColor( "Color", colorCycle ), ParamStyle("Style", styleLine | styleNoLabel ) | styleNoRescale ); \r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("Long MA");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 100, 2, 400, 1 );\r\nPlot( MA( P, Periods ), _DEFAULT_NAME(), ParamColor( "Color", colorCycle ), ParamStyle("Style", styleLine | styleNoLabel ) | styleNoRescale ); \r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("BBands");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 15, 2, 100, 1 );\r\nWidth = Param("Width", 2, 0, 10, 0.05 );\r\nColor = ParamColor("Color", colorLightGrey );\r\nColor = ColorBlend( Color,  GetChartBkColor(), 0.5 );\r\nStyle = ParamStyle("Style", styleLine | styleNoLabel ) | styleNoRescale;;\r\nPlot( bbt = BBandTop( P, Periods, Width ), "BBTop" + _PARAM_VALUES(), Color, Style ); \r\nPlot( bbb = BBandBot( P, Periods, Width ), "BBBot" + _PARAM_VALUES(), Color, Style ); \r\nPlotOHLC( bbt, bbt, bbb, bbb, "", ColorBlend( Color, GetChartBkColor(), 0.7 ), styleNoLabel | styleCloud | styleNoRescale, Null, Null, Null, -1 );\r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("Volume");\r\nColor = ParamColor("Color", ColorRGB( 128, 128, 192 ) );\r\nPlot( Volume, _DEFAULT_NAME(), ColorBlend( Color, GetChartBkColor(), 0.5  ), styleNoTitle | ParamStyle( "Style", styleHistogram | styleOwnScale | styleThick | styleNoLabel, maskHistogram  ), 2 );\r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("Price Interpretation");\r\nmovshort = ParamField("Short Time MA", 8 );\r\nmovmed = ParamField("Mid Time MA", 9 );\r\nmovlong = ParamField("Long Time MA", 10 );\r\nbtop = ParamField("BBTop", 11 );\r\nbbot = ParamField("BBBottom", 12 );\r\nif( Status("action") == actionCommentary )\r\n{\r\nwidth = btop - bbot;\r\nlslop = LinRegSlope( C, 30 ) + 100;\r\nlslo = LLV( lslop, 90 );\r\nlshi = HHV( lslop, 90 );\r\nlswidth = lshi - lslo;\r\ntrend = 100*( lslop - lslo )/lswidth;\r\n\r\nmawidth = MA( width, 100 );\r\nrelwidth = 100*(width - mawidth)/mawidth;\r\n\r\n_N( tname = Name()+"("+FullName()+")" );\r\n\r\nprintf("Price and moving averages:\\n");\r\nprintf( tname + " has closed " + WriteIf( C &gt; movshort, "above" , "below" ) + " its Short time moving average. ");\r\n\r\nprintf("\\nShort time moving average is currently " + WriteIf( movshort &gt; movmed, "above", "below") + " mid-time, AND " + WriteIf( movshort &gt; movlong, "above", "below" ) + " long time moving averages.");\r\n\r\nprintf("\\nThe relationship between price and moving averages is: "+\r\nWriteIf( C &gt; movshort AND movshort &gt; movmed, "bullish",\r\nWriteIf( C &lt; movshort AND movshort &lt; movmed, "bearish", "neutral" ) ) + " in short-term, and "+\r\nWriteIf( movshort &gt; movmed AND movmed &gt; movlong , "bullish",\r\nWriteIf( movshort &lt; movmed AND movmed &lt; movlong, "bearish", "neutral" ) ) + " in mid-long term. ");\r\n\r\nprintf("\\n\\nBollinger Bands:\\n");\r\nprintf(tname+ " has closed " + \r\nWriteIf( C &lt; bbot, "below the lower band by " +\r\nWriteVal( 100 *( bbot-C )/ width, 1.1 ) + "%%. " +\r\nWriteIf( trend &lt; 30, " This combined with the steep downtrend can suggest that the downward trend in prices has a good chance of continuing.  However, a short-term pull-back inside the bands is likely.",\r\nWriteIf( trend &gt; 30 AND trend &lt; 70, "Although prices have broken the lower band and a downside breakout is possible, the most likely scenario for "+tname+" is to continue within current trading range.", "" ) ), "" ) +\r\n\r\nWriteIf( C &gt; btop, "above the upper band by " +\r\nWriteVal( 100 *( C- btop )/ width, 1.1 ) + "%%. " +\r\nWriteIf( trend &gt; 70, " This combined with the steep uptrend suggests that the upward trend in prices has a good chance of continuing.  However, a short-term pull-back inside the bands is likely.",\r\nWriteIf( trend &gt; 30 AND trend &lt; 70, "Although prices have broken the upper band and a upside breakout is possible, the most likely scenario for "+tname+" is to continue within current trading range.", "" ) ), "" ) +\r\n\r\nWriteIf( C &lt; btop AND ( ( btop - C ) / width ) &lt; 0.5, \r\n"below upper band by " +\r\nWriteVal( 100 *( btop - C )/ width, 1.1 ) + "%%. ", \r\nWriteIf( C &lt; btop AND C &gt; bbot , "above bottom band by " +\r\nWriteVal( 100 *( C - bbot )/ width, 1.1 ) + "%%. ", "" ) ));\r\n\r\nprintf("\\n"+\r\nWriteIf( ( trend &gt; 30 AND trend &lt; 70 AND ( C &gt; btop OR C &lt; bbot ) ) AND abs(relwidth) &gt; 40,\r\n\t\t "This picture becomes somewhat unclear due to the fact that Bollinger Bands are  currently",\r\n\t\t "Bollinger Bands are " )+\t  \r\nWriteVal( abs( relwidth ), 1.1 ) + "%% " +\r\nWriteIf( relwidth &gt; 0, "wider" , "narrower" ) +\r\n" than normal.");\r\n\r\nprintf("\\n");\r\n\r\nprintf(\r\nWriteIf( abs( relwidth ) &lt; 40, "The current width of the bands (alone) does not suggest anything conclusive about the future volatility or movement of prices.","")+\r\nWriteIf( relwidth &lt; -40, "The narrow width of the bands suggests low volatility as compared to " + tname + "'s normal range.  Therefore, the probability of volatility increasing with a sharp price move has increased for the near-term. "+\r\n"The bands have been in this narrow range for " + WriteVal(BarsSince(Cross(-40,relwidth)),1.0) + " bars. The probability of a significant price move increases the longer the bands remain in this narrow range." ,"")+\r\nWriteIf( relwidth &gt; 40, "The large width of the bands suggest high volatility as compared to " + tname + "'s normal range.  Therefore, the probability of volatility decreasing and prices entering (or remaining in) a trading range has increased for the near-term. "+\r\n"The bands have been in this wide range for  " + WriteVal(BarsSince(Cross(relwidth,40)),1.0) + " bars.The probability of prices consolidating into a less volatile trading range increases the longer the bands remain in this wide range." ,""));\r\n\r\nprintf("\\n\\nThis commentary is not a recommendation to buy or sell. Use at your own risk.");\r\n}\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\Price (all in one) 5.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741835</MoreFlags>
			<Min>1186.4</Min>
			<Max>1486.34</Max>
		</Pane>
		<Pane>
			<ChartID>1365</ChartID>
			<PercentHeight>16.6667</PercentHeight>
			<Formula>_SECTION_BEGIN("ATR");\r\nperiods = Param( "Periods", 15, 1, 200, 1 );\r\nPlot( ATR(periods), _DEFAULT_NAME(), ParamColor( "Color", colorCycle ), ParamStyle("Style") );\r\nPlot( MA(ATR(periods),5), "5 MA", colorRed, ParamStyle("Style") );\r\nPlot( MA(ATR(periods),21), "21 MA", colorBlue, ParamStyle("Style") );\r\n\r\n_SECTION_END();\r\n\r\n</Formula>
			<FilePath>Formulas\\Custom\\ATR - Average True Range 1.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1342177281</MoreFlags>
			<Min>32.0452</Min>
			<Max>46.1263</Max>
		</Pane>
		<Pane>
			<ChartID>1366</ChartID>
			<PercentHeight>16.6667</PercentHeight>
			<Formula>_SECTION_BEGIN("RSI");\r\nSetChartOptions(0,0,chartGrid30|chartGrid70);\r\nperiods = Param( "Periods", 15, 1, 200, 1 );\r\nPlot( RSI( periods), _DEFAULT_NAME(), ParamColor( "Color", colorCycle ), ParamStyle("Style")  );\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\RSI - Relative Strength Index 3.afl</FilePath>
			<Flags>3072</Flags>
			<MoreFlags>1073741825</MoreFlags>
			<Min>26.9612</Min>
			<Max>61.4088</Max>
		</Pane>
		<Pane>
			<ChartID>1367</ChartID>
			<PercentHeight>16.6667</PercentHeight>
			<Formula>_SECTION_BEGIN("RS");\r\nbase = ParamStr("RS base ticker", GetBaseIndex() );\r\nPlot( RelStrength(base), _SECTION_NAME() + "(" + base + ")", ParamColor( "color", colorCycle ), ParamStyle("Style")  );\r\nPlot( MA(RelStrength(base),5), "5 MA", colorRed, ParamStyle("Style") );\r\nPlot( MA(RelStrength(base),21), "21 MA", colorBlue, ParamStyle("Style") );\r\n\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Custom\\RS - Comparative Relative Strength 1.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1342177281</MoreFlags>
			<Min>9345.58</Min>
			<Max>16731.2</Max>
		</Pane>
	</Sheet>
	<Sheet>
		<Name>Step 2</Name>
		<Pane>
			<ChartID>1388</ChartID>
			<PercentHeight>65.5405</PercentHeight>
			<Formula>_SECTION_BEGIN("Ichimoku");\r\nprds = Param( "Standard Line Periods", 13, 5, 26, 1 );\r\nturn = Param( "Turning Line Periods", 3, 3, 10, 1 );\r\ndelay = Param( "Delayed Line Periods", 12, 4, 26, 1 );\r\nspan = Param( "Spans Periods", 16, 10, 52, 1 );\r\n\r\nTL = ( HHV( H, turn ) + LLV( L, turn ) ) / 2;\r\nSL = ( HHV( H, prds ) + LLV( L, prds ) ) / 2;\r\nDL = Ref( C, delay );\r\nSp1 = ( SL + TL ) / 2;\r\nSp2 = ( HHV( H, span ) + LLV( L, span ) ) / 2;\r\n\r\n_N( Title = StrFormat( "{{NAME}} - {{INTERVAL}} {{DATE}} Open %g, Hi %g, Lo %g, Close %g (%.1f%%) Vol " + WriteVal( V, 1.0 ) + " {{VALUES}}", O, H, L, C, SelectedValue( ROC( C, 1 ) ) ) );\r\n\r\nPlot( C, "Close", colorDefault, styleNoTitle | GetPriceStyle() );\r\nPlot( SL, "SL", colorRed, styleThick | styleNoLabel );\r\nPlot( TL, "TL", colorGreen, styleThick | styleNoLabel );\r\ncolor = IIf( Sp1 &gt; Sp2, ParamColor( "Span1 Color", ColorRGB( 0, 255, 0 ) ), ParamColor( "Span2 Color", ColorRGB( 255, 104, 32 ) ) );\r\nPlotOHLC ( Sp1, Sp1, Sp2, Sp2, "Cloud", Color, styleCloud | styleNoLabel, Null, Null, delay, -2 );\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\Ichimoku 2.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1342177281</MoreFlags>
			<Min>1185.03</Min>
			<Max>1558.58</Max>
		</Pane>
		<Pane>
			<ChartID>1369</ChartID>
			<PercentHeight>17.5676</PercentHeight>
			<Formula>_SECTION_BEGIN("MACD");\r\nr1 = Param( "Fast avg", 12, 2, 200, 1 );\r\nr2 = Param( "Slow avg", 26, 2, 200, 1 );\r\nr3 = Param( "Signal avg", 9, 2, 200, 1 );\r\nPlot( ml = MACD(r1, r2), StrFormat(_SECTION_NAME()+"(%g,%g)", r1, r2), ParamColor("MACD color", colorRed ), ParamStyle("MACD style") );\r\nPlot( sl = Signal(r1,r2,r3), "Signal" + _PARAM_VALUES(), ParamColor("Signal color", colorBlue ), ParamStyle("Signal style") );\r\nPlot( ml-sl, "MACD Histogram", ParamColor("Histogram color", colorDefault ), styleNoTitle | ParamStyle("Histogram style", styleHistogram | styleNoLabel, maskHistogram ) );\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\MACD - Moving Average Convergence Divergence 4.afl</FilePath>
			<Flags>768</Flags>
			<MoreFlags>1342177281</MoreFlags>
			<Min>-23.7817</Min>
			<Max>10.4724</Max>
		</Pane>
		<Pane>
			<ChartID>1538</ChartID>
			<PercentHeight>16.8919</PercentHeight>
			<Formula>_SECTION_BEGIN("AccDist");\r\nPlot( AccDist(), _DEFAULT_NAME(), ParamColor("Color", colorCycle ), ParamStyle("Style") );\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\AccDist - Accumulation Distribution 1.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>805306369</MoreFlags>
			<Min>7.05774e+006</Min>
			<Max>1.05797e+007</Max>
		</Pane>
	</Sheet>
	<Sheet>
		<Name>Step 3</Name>
		<Pane>
			<ChartID>1446</ChartID>
			<PercentHeight>60</PercentHeight>
			<Formula>_SECTION_BEGIN("Price");\r\nSetChartOptions(0,chartShowArrows|chartShowDates);\r\n_N(Title = StrFormat("{{NAME}} - {{INTERVAL}} {{DATE}} Open %g, Hi %g, Lo %g, Close %g (%.1f%%) {{VALUES}}", O, H, L, C, SelectedValue( ROC( C, 1 ) ) ));\r\nPlot( C, "Close", ParamColor("Color", colorDefault ), styleNoTitle | ParamStyle("Style") | GetPriceStyle() ); \r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\Price 1.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741835</MoreFlags>
			<Min>1186.4</Min>
			<Max>1486.34</Max>
		</Pane>
		<Pane>
			<ChartID>1447</ChartID>
			<PercentHeight>20</PercentHeight>
			<Formula>_SECTION_BEGIN("CCI");\r\nperiods = Param( "Periods", 14, 2, 200, 1 );\r\nPlot( CCI( periods ), _DEFAULT_NAME(), ParamColor( "Color",  colorCycle ), ParamStyle("Style")  );\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\CCI - Commodity Channel Index 1.afl</FilePath>
			<Flags>32768</Flags>
			<MoreFlags>1342177281</MoreFlags>
			<Min>-267.182</Min>
			<Max>135.519</Max>
		</Pane>
		<Pane>
			<ChartID>1448</ChartID>
			<PercentHeight>20</PercentHeight>
			<Formula>_SECTION_BEGIN("CCI");\r\nperiods = Param( "Periods", 14, 2, 200, 1 );\r\nPlot( CCI( periods ), _DEFAULT_NAME(), ParamColor( "Color",  colorCycle ), ParamStyle("Style")  );\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\CCI - Commodity Channel Index 2.afl</FilePath>
			<Flags>32768</Flags>
			<MoreFlags>1342177281</MoreFlags>
			<Min>-207.01</Min>
			<Max>-43.1599</Max>
		</Pane>
	</Sheet>
	<Sheet>
		<Name>BackTest</Name>
		<Pane>
			<ChartID>1370</ChartID>
			<PercentHeight>60</PercentHeight>
			<Formula>\r\n_SECTION_BEGIN( "Price" );\r\nSetChartOptions( 0, chartShowArrows | chartShowDates );\r\n_N( Title = StrFormat( "{{NAME}} - {{INTERVAL}} {{DATE}} Open %g, Hi %g, Lo %g, Close %g (%.1f%%) {{VALUES}}", O, H, L, C, SelectedValue( ROC( C, 1 ) ) ) );\r\nPlot( C, "Close", ParamColor( "Color", colorDefault ), styleNoTitle | ParamStyle( "Style" ) | GetPriceStyle() );\r\n_SECTION_END();\r\n\r\nFilter = Close &gt; 0;\r\n\r\n/* ichioku analysis Start */\r\nConvLine = ( HHV( H, 9 ) + LLV( L, 9 ) ) / 2;\r\nBaseLine = ( HHV( H, 26 ) + LLV( L, 26 ) ) / 2;\r\nLeadSpanA = ( ConvLine + BaseLine ) / 2;\r\nLeadSpanB = ( HHV( H, 52 ) + LLV( L, 52 ) ) / 2;\r\nLagSpan = Ref( C, 26 );\r\n\r\nbuyIchimoku = L &gt; LeadSpanA AND L &gt; LeadSpanB AND Cross( ConvLine , BaseLine );\r\nselIchimoku = Cross( BaseLine , ConvLine );\r\n\r\nprintf( "Ichioku buy =%f sel =%f\\n", buyIchimoku, selIchimoku );\r\n/* ichioku analysis End */\r\n\r\n/* MA slope based analysis Start */\r\nMAS = MA( C, 20 );\r\nMAM = MA( C, 50 );\r\nMAL = MA( C, 100 );\r\n\r\n\r\nTS = LinRegSlope( MAS, 2 ); // TL = Trend Long\r\nTM = LinRegSlope( MAM, 2 ); // TM = Trend Medium\r\nTL = LinRegSlope( MAL, 2 ); // TS = Trend Short\r\n\r\nTLL = IIf( TL &gt; 0, True, False );\r\nTMM = IIf( TM &gt; 0, True, False );\r\nTSS = IIf( TS &gt; 0, True, False );\r\n\r\nbuySlope = MAS &gt; MAM AND MAM &gt; MAL AND TSS &gt; 0 AND Ref( TSS, -1 ) == 1 AND TMM == 1 AND Ref( TMM, -1 ) == 1 AND TLL == 1;\r\nsellSlope = TSS == 0 OR TMM == 0 OR TLL == 0 ;\r\n\r\nprintf( "sellSlope buy =%f sel =%f\\n", buySlope, sellSlope );\r\n/* MA slope based analysis End */\r\n\r\n/* Hammer and Inside day start */\r\nL1 = Ref( L, -1 );\r\nL2 = Ref( L, -2 );\r\nL3 = Ref( L, -3 );\r\nL4 = Ref( L, -4 );\r\nO1 = Ref( O, -1 );\r\nO2 = Ref( O, -2 );\r\nO3 = Ref( O, -3 );\r\nO4 = Ref( O, -4 );\r\nH1 = Ref( H, -1 );\r\nH2 = Ref( H, -2 );\r\nH3 = Ref( H, -3 );\r\nH4 = Ref( H, -4 );\r\nC1 = Ref( C, -1 );\r\nC2 = Ref( C, -2 );\r\nC3 = Ref( C, -3 );\r\nC4 = Ref( C, -4 );\r\n\r\ngreenCandel = C &gt; O ;\r\ndhammertrend = ( L &lt; L1 ) AND( L1 &lt; L2 )AND( L2 &lt; L3 ) AND( L3 &lt; L4 );\r\nuhangingmantrend = ( H &gt; H1 ) AND( H1 &gt; H2 )AND( H2 &gt; H3 ) AND( H3 &gt; H4 );\r\nDoji  = ( abs( O - C ) &lt;= ( ( H - L ) * 0.1 ) );\r\nHammer  = ( ( ( H - L ) &gt; 3 * ( O - C ) ) AND( ( C - L ) / ( .001 + H - L ) &gt; 0.6 ) AND( ( O - L ) / ( .001 + H - L ) &gt; 0.6 ) AND dhammertrend AND NOT Doji );\r\nsmallotherSideWick = IIf( greenCandel, ( ( O - L ) / ( 0.001 + H - L ) &lt; 0.05 ), ( ( H - O ) / ( 0.001 + H - L ) &lt; 0.05 ) );\r\nHammer = Hammer AND smallotherSideWick;\r\n//printf("%f smallotherSideWick %f\\n",greenCandel,smallotherSideWick);\r\nHarami =\r\n    IIf( O &gt; C AND O1 &gt; C1 AND O&lt;O1 AND C&gt;C1, 1,\r\n         IIf( O &gt; C AND C1 &gt; O1 AND C &gt; O1 AND O &lt; C1, 1,\r\n              IIf( C &gt; O AND C1 &gt; O1 AND C&lt;C1 AND O&gt;O1, 1,\r\n                   IIf( C &gt; O AND O1 &gt; C1 AND O &gt; C1 AND C &lt; O1, 1, 0 ) ) ) );\r\n\r\nLongBlackCandle = ( O &gt; C AND( O - C ) / ( .001 + H - L ) &gt; .6 );\r\nLongWhiteCandle  = ( ( C &gt; O ) AND( ( C - O ) / ( .001 + H - L ) &gt; .6 ) );\r\n\r\nBullishHarami = ( Harami AND( O1 &gt; C1 ) AND Ref( LongBlackCandle, -1 ) AND NOT LongWhiteCandle );\r\n\r\ndtrend = ( L1 &lt; L2 )AND( L2 &lt; L3 ) AND( L3 &lt; L4 );\r\nutrend = ( H1 &gt; H2 )AND( H2 &gt; H3 ) AND( H3 &gt; H4 );\r\nBullishEngulfing  = ( LongWhiteCandle AND dtrend  AND( O1 &gt; C1 ) AND( C &gt; O ) AND( C &gt;= O1 ) AND( C1 &gt;= O ) AND( ( C - O ) &gt; ( O1 - C1 ) ) );\r\n\r\nMHT =  HHV( H, 5 ) == H;\r\nBearishHarami = ( ( C1 &gt; O1 ) AND( O &gt; C ) AND( O &lt;= C1 ) AND( O1 &lt;= C ) AND( ( O - C ) &lt; ( C1 - O1 ) ) );\r\nHangingMan  = ( ( ( H - L ) &gt; 4 * ( O - C ) ) AND( ( C - L ) / ( .001 + H - L ) &gt;= 0.75 ) AND( ( O - L ) / ( .001 + H - L ) &gt;= 0.75 ) AND uhangingmantrend AND NOT Doji );\r\nBearishEngulfing  = ( MHT AND utrend  AND LongBlackCandle AND( C1 &gt; O1 ) AND( O &gt; C ) AND( O &gt;= C1 ) AND( O1 &gt;= C ) AND( ( O - C ) &gt; ( C1 - O1 ) ) );\r\n\r\nstoD = StochD( 4, 1, 1 );\r\ncandlStocBuy = stoD &gt; 20 AND Hammer OR BullishHarami OR BullishEngulfing;\r\ncandlStocSell = stoD &lt; 80 AND HangingMan OR BearishHarami OR BearishEngulfing;\r\n\r\nprintf( "candel buy =%f sel =%f\\n", candlStocBuy, candlStocSell );\r\n/* Hammer and Inside day  */\r\n/* macd with uptrend using EMA 5,21,200 */\r\nweekly_ma = EMA( C, 5 );\r\nmonthly_ma = EMA( C, 21 );\r\nyearly_ma = EMA( C, 200 );\r\n\r\nPlot( weekly_ma, "5 day EMA", colorYellow, styleDashed );\r\nPlot( monthly_ma, "21 day EMA", colorBlue, styleDashed );\r\nPlot( yearly_ma, "200 day EMA", colorBlueGrey, styleDashed );\r\n\r\ndaily_uptrend = weekly_ma &gt; monthly_ma AND monthly_ma  &gt; yearly_ma;\r\ndaily_downtrend = NOT daily_uptrend;\r\n\r\nind_macd = MACD( 13, 21 );\r\nsig_macd = Signal( 13, 21, 9 );\r\n\r\nmacdBuy =  Cross( ind_macd, sig_macd );\r\nmacdSell = Cross( sig_macd, ind_macd );\r\n\r\nprintf( "MACD buy =%f sel =%f\\n", macdBuy, macdSell );\r\n/* macd with uptrend using EMA 5,21,200 */\r\n/*bb strategy start*/\r\nbbtop2 = BBandTop( C, 13, 2 );\r\nbbBtm2 = BBandBot( C, 13, 2 );\r\nbbtop1 = BBandTop( C, 13, 1 );\r\nbbBtm1 = BBandBot( C, 13, 1 );\r\nind_rsi = RSI( 13 );\r\n//bbTopBuySignal = ( C &gt; bbtop1 AND H &lt; bbtop2 );\r\n//bbTopBuySignal = bbTopBuySignal AND Ref( C, -1 ) &gt; Ref( bbtop1, -1 ) AND Ref( H, -1 ) &lt; Ref( bbtop2, -1 );\r\n//bbTopBuySignal = bbTopBuySignal AND Ref( C, -2 ) &gt; Ref( bbtop1, -2 ) AND Ref( H, -2 ) &lt; Ref( bbtop2, -2 );\r\nbbBuy =  L &lt; bbBtm2 AND ind_rsi &lt; 30;\r\nbbSell = H &gt; bbtop2 AND ind_rsi &gt; 70;\r\nprintf( "BB Band buy =%f sel =%f\\n", bbBuy, bbSell );\r\n/*bb strategy end*/\r\n/*cci strategy*/\r\nshrt_cci = CCI( 21 );\r\nTimeFrameSet( inWeekly );\r\nlng_cci = CCI( 13 );\r\nTimeFrameRestore();\r\n\r\nbuyCCI = lng_cci &gt; -100 AND Cross( shrt_cci , -100 ) \t;\r\nsellCCI = lng_cci &gt; 100 OR shrt_cci &gt; 100;\r\n\r\nprintf( "CCI buy =%f sel =%f\\n", buyCCI, sellCCI );\r\n/*cci strategy end*/\r\n/*super trend */\r\nFactor = 8;\r\nPd = 13;\r\n\r\nUp = ( H + L ) / 2 + ( Factor*ATR( Pd ) );\r\nDn = ( H + L ) / 2 - ( Factor*ATR( Pd ) );\r\niATR = ATR( Pd );\r\nTrendUp = TrendDown = Null;\r\ntrend[0] = 1;\r\nchangeOfTrend = 0;\r\nflag = flagh = 0;\r\n\r\nfor( i = 1; i &lt; BarCount - 1; i++ )\r\n{\r\n    TrendUp[i] = Null;\r\n    TrendDown[i] = Null;\r\n\r\n    trend[i] = 1;\r\n\r\n\r\n    if( Close[i] &gt; Up[i - 1] )\r\n    {\r\n        trend[i] = 1;\r\n\r\n        if( trend[i - 1] == -1 ) changeOfTrend = 1;\r\n\r\n    }\r\n    else\r\n        if( Close[i] &lt; Dn[i - 1] )\r\n        {\r\n            trend[i] = -1;\r\n\r\n            if( trend[i - 1] == 1 ) changeOfTrend = 1;\r\n        }\r\n        else\r\n            if( trend[i - 1] == 1 )\r\n            {\r\n                trend[i] = 1;\r\n                changeOfTrend = 0;\r\n            }\r\n            else\r\n                if( trend[i - 1] == -1 )\r\n                {\r\n                    trend[i] = -1;\r\n                    changeOfTrend = 0;\r\n                }\r\n\r\n    if( trend[i] &lt; 0 &amp;&amp; trend[i - 1] &gt; 0 )\r\n    {\r\n        flag = 1;\r\n    }\r\n    else\r\n    {\r\n        flag = 0;\r\n    }\r\n\r\n    if( trend[i] &gt; 0 &amp;&amp; trend[i - 1] &lt; 0 )\r\n    {\r\n        flagh = 1;\r\n    }\r\n    else\r\n    {\r\n        flagh = 0;\r\n    }\r\n\r\n    if( trend[i] &gt; 0 &amp;&amp; Dn[i] &lt; Dn[i - 1] )\r\n    {\r\n        Dn[i] = Dn[i - 1];\r\n    }\r\n\r\n    if( trend[i] &lt; 0 &amp;&amp; Up[i] &gt; Up[i - 1] )\r\n    {\r\n        Up[i] = Up[i - 1];\r\n    }\r\n\r\n    if( flag == 1 )\r\n    {\r\n        Up[i] = ( H[i] + L[i] ) / 2 + ( Factor * iATR[i] );;\r\n    }\r\n\r\n    if( flagh == 1 )\r\n    {\r\n        Dn[i] = ( H[i] + L[i] ) / 2 - ( Factor * iATR[i] );;\r\n    }\r\n\r\n    if( trend[i] == 1 )\r\n    {\r\n        TrendUp[i] = Dn[i];\r\n\r\n        if( changeOfTrend == 1 )\r\n        {\r\n            TrendUp[i - 1] = TrendDown[i - 1];\r\n            changeOfTrend = 0;\r\n        }\r\n    }\r\n    else\r\n        if( trend[i] == -1 )\r\n        {\r\n            TrendDown[i] = Up[i];\r\n\r\n            if( changeOfTrend == 1 )\r\n            {\r\n                TrendDown[i - 1] = TrendUp[i - 1];\r\n                changeOfTrend = 0;\r\n            }\r\n        }\r\n}\r\n\r\nPlot( TrendUp, "Trend", colorGreen );\r\nPlot( TrendDown, "Down", colorRed );\r\nsuperTrendBuy = trend==1;\r\nsuperTrendSell = trend==-1;\r\nprintf( "super trend buy =%f sel =%f\\n", superTrendBuy, superTrendSell );\r\n/*super trend end*/\r\n/*delivery volume*/\r\ndelVol_ma_shrt = MA( Aux1, 5 );\r\ndelVol_ma_long = MA( Aux1, 21 );\r\ndelVol_check = Aux1 &gt; delVol_ma_shrt AND delVol_ma_shrt &gt; delVol_ma_long;\r\n/*delivery volume ends*/\r\n/*open interest check*/\r\ncheck_OI = OI &gt; Ref( OI, -1 ) AND Ref( OI, -1 ) &gt; Ref( OI, -2 );\r\n/*open interest check end*/\r\nttlBuy = bbBuy + macdBuy + candlStocBuy + buySlope + buyIchimoku + buyCCI +superTrendBuy;\r\nttlSel = bbSell + macdSell + candlStocSell + sellSlope + selIchimoku + sellCCI +superTrendSell;\r\n\r\n\r\n\r\nAddColumn( ttlBuy, "Buy Strength", 1.2, colorBlack, IIf(ttlBuy&gt;=3,colorGreen,IIf(ttlBuy==2 ,ColorRGB(144,238,144),IIf(ttlBuy==1,ColorRGB(173,255,47),colorLightGrey))), width = 100 );\r\nAddColumn( ttlSel, "Sel Strength", 1.2, colorBlack, colorLightGrey, width = 100 );\r\n\r\nAddColumn( delVol_check, "Delevery Check", 1.2, colorBlack, IIf(delVol_check,colorGreen,colorLightGrey), width = 100 );\r\nAddColumn( check_OI, "OI Check", 1.2, colorBlack, IIf(check_OI,colorGreen,colorLightGrey), width = 100 );\r\n\r\nAddColumn( buyIchimoku, "Buy Ichimoku", 1.2, colorBlack, IIf(buyIchimoku,colorGreen,colorLightGrey), width = 100 );\r\nAddColumn( selIchimoku, "Sel Ichimoku", 1.2, colorBlack, colorLightGrey, width = 100 );\r\n\r\nAddColumn( candlStocBuy, "Buy Sto Bull candel", 1.2, colorBlack, IIf(candlStocBuy,colorGreen,colorLightGrey), width = 100 );\r\nAddColumn( candlStocSell, "Sel Sto Bull candel", 1.2, colorBlack, colorLightGrey, width = 100 );\r\n\r\nAddColumn( bbBuy, "Buy BB Band", 1.2, colorBlack, IIf(bbBuy,colorGreen,colorLightGrey), width = 100 );\r\nAddColumn( bbSell, "Sel BB Band", 1.2, colorBlack, colorLightGrey, width = 100 );\r\n\r\nAddColumn( macdBuy, "Buy MACD", 1.2, colorBlack, IIf(macdBuy,colorGreen,colorLightGrey), width = 100 );\r\nAddColumn( macdSell, "Sel MACD", 1.2, colorBlack, colorLightGrey, width = 100 );\r\n\r\nAddColumn( buyCCI, "Buy CCI", 1.2, colorBlack, IIf(buyCCI,colorGreen,colorLightGrey), width = 100 );\r\nAddColumn( sellCCI, "Sel CCI", 1.2, colorBlack, colorLightGrey, width = 100 );\r\n\r\nAddColumn( superTrendBuy, "Buy superTrend", 1.2, colorBlack, IIf(superTrendBuy,colorGreen,colorLightGrey), width = 100 );\r\nAddColumn( superTrendSell, "Sel superTrend", 1.2, colorBlack, colorLightGrey, width = 100 );\r\n\r\nAddColumn( buySlope, "Buy slope", 1.2, colorBlack, IIf(buySlope,colorGreen,colorLightGrey), width = 100 );\r\nAddColumn( sellSlope, "Sel slope", 1.2, colorBlack, colorLightGrey, width = 100 );\r\n\r\n_SECTION_BEGIN( "Price1" );\r\nSetChartOptions( 0, chartShowArrows | chartShowDates );\r\n_N( Title = StrFormat( "{{NAME}} - {{INTERVAL}} {{DATE}} Open %g, Hi %g, Lo %g, Close %g (%.1f%%) {{VALUES}}", O, H, L, C, SelectedValue( ROC( C, 1 ) ) ) );\r\nPlot( C, "Close", ParamColor( "Color", colorDefault ), styleNoTitle | ParamStyle( "Style" ) | GetPriceStyle() );\r\n_SECTION_END();\r\n\r\n\r\nPositionScore = ttlBuy - ttlSel;\r\n\r\nBuy = Ref( candlStocBuy, -1 ) and Ref( bbBuy, -1 )AND Ref( delVol_check, -1 ) AND Ref( C, -1 ) &gt;= L AND Ref( C, -1 ) &lt;= H; //AND Ref( check_OI, -1 ) &gt; Ref( ttlSel, -1 )\r\n\r\nSell = candlStocSell and bbSell;//ttlSel  &gt; ttlBuy\r\n\r\n\r\nCover = Short = 0;\r\n\r\nBuy = ExRem( Buy, Sell );\r\nSell = ExRem( Sell, Buy );\r\n\r\nopenlong = Flip( Buy, Sell );\r\n\r\nBuyPrice = ValueWhen( Buy, C ) ;\r\nSellPrice = ValueWhen( Sell, C ) ;\r\n\r\nTG1 = 5;\r\nTG2 = 10;\r\nSL = 5;\r\nTSLP = 50;\r\nMinSpread =  0.05;\r\nBTP1 = ( round( BuyPrice * ( 1 + TG1 / 100 ) / MinSpread ) * MinSpread );\r\nBTP2 = ( round( BuyPrice * ( 1 + TG2 / 100 ) / MinSpread ) * MinSpread );\r\nBTPrice1 = IIf( openlong OR Sell, BTP1, Null );\r\nBTPrice2 = IIf( openlong OR Sell, BTP2, Null );\r\n\r\nBSLP = ( round( BuyPrice * ( 1 - SL / 100 ) / MinSpread ) * MinSpread );\r\nBSLPrice = IIf( openlong OR Sell, BSLP, Null );\r\n\r\nTSell1 = ( H &gt;= BTPrice1 ) AND !Buy AND !IsNull( BTPrice1 );\r\nTSell2 = ( H &gt;= BTPrice2 ) AND !Buy AND !IsNull( BTPrice2 );\r\nSLSell = ( L &lt;= BSLPrice AND !Buy ) AND !IsNull( BSLPrice );\r\n\r\nSell = ( Sell OR TSell2 ) OR SLSell;\r\n\r\nBuy = ExRem( Buy, Sell );\r\nSell = ExRem( Sell, Buy );\r\nOpenLong = Flip( Buy, Sell );\r\n\r\n\r\nTSell1 = ( OpenLong ) AND TSell1;\r\nTSell2 = ( OpenLong OR Sell ) AND TSell2;\r\nSLSell = ( OpenLong OR Sell ) AND SLSell;\r\n\r\nTSell1 = ExRem( TSell1, Sell );\r\nTSell2 = ExRem( TSell2, Sell );\r\nSLSell = ExRem( SLSell, Sell );\r\n\r\n\r\nBuyPrice = IIf( OpenLong OR Sell, BuyPrice, Null );\r\nBTPrice1 = IIf( OpenLong OR Sell, BTPrice1, Null );\r\nBTPrice2 = IIf( OpenLong OR Sell, BTPrice2, Null );\r\nBSLPrice = IIf( OpenLong OR Sell, BSLPrice, Null );\r\n\r\n\r\nLongTrailPeriod = Flip( Ref( TSell1, -1 ), Sell ); //start from Tsell1 and finish at sell.\r\n\r\n\r\nfunction LongTrailPrice( Trigger, TSLP )\r\n{\r\n    return HighestSince( Trigger, HighestSince( Trigger, Ref( H, -1 ), 1 ) - TSLP, 1 );\r\n}\r\n\r\nLTSLV = round( ( TSLP * ( BTPrice1 - BuyPrice ) / 100 ) / MinSpread ) * MinSpread;\r\n\r\nLongTrailPr = IIf( OpenLong AND LongTrailPeriod, LongTrailPrice( Ref( TSell1, -1 ), LTSLV ), Null );\r\nLongTrailPr = IIf( LongTrailPr == BTPrice1, LongTrailPr - MinSpread, LongTrailPr );\r\n\r\nTrailSell = IIf( IsNull( LongTrailPr ), 0, ( L &lt;= LongTrailPr ) );\r\n\r\nSell = Sell OR TrailSell;\r\nBuy = ExRem( Buy, Sell );\r\nSell = ExRem( Sell, Buy );\r\nCover = ExRem( Cover, Short );\r\n\r\nOpenLong = Flip( Buy, Sell );\r\n\r\nTSell1 = ( OpenLong ) AND TSell1;\r\nTSell2 = ( OpenLong OR Sell ) AND TSell2;\r\nSLSell = ( OpenLong OR Sell ) AND SLSell;\r\nTrailSell = ( OpenLong OR Sell ) AND TrailSell;\r\n\r\nTSell1 = ExRem( TSell1, Sell );\r\nTSell2 = ExRem( TSell2, Sell );\r\nSLSell = ExRem( SLSell, Sell );\r\n\r\n\r\nTrailSell = ExRem( TrailSell, Sell );\r\n\r\nLongTrailPeriod = Flip( TSell1, Sell );\r\n\r\nBuyPrice = IIf( OpenLong OR Sell, BuyPrice, Null );\r\nBTPrice1 = IIf( OpenLong OR Sell, BTPrice1, Null );\r\nBTPrice2 = IIf( OpenLong OR Sell, BTPrice2, Null );\r\nBSLPrice = IIf( OpenLong OR Sell, BSLPrice, Null );\r\nLongTrailPr = IIf( LongTrailPeriod OR TrailSell, LongTrailPr, Null );\r\nSellPrice = IIf( Sell*SLSell, BSLPrice, IIf( Sell*TSell1, BTPrice1, IIf( Sell*TSell2, BTPrice2, IIf( Sell*TrailSell, LongTrailPr, IIf( Sell, Close, Null ) ) ) ) );\r\n\r\n\r\n\r\nPlot( BuyPrice, "Buy Price", colorBrightGreen, styleLine | styleThick | styleNoLabel | styleNoRescale | styleNoTitle );\r\nPlot( BTPrice1, "Buy Target Price1", colorGreen, styleLine | styleDashed | styleNoTitle | styleNoRescale );\r\nPlot( BTPrice2, "Buy Target Price2", colorGreen, styleLine | styleDashed | styleNoTitle | styleNoRescale );\r\nPlot( BSLPrice, "Buy SL Price", colorRed, styleLine | styleDashed | styleNoTitle | styleNoRescale );\r\nPlot( LongTrailPr, "Long Trail Price", colorBrightGreen , styleStaircase | styleThick | styleNoTitle | styleNoRescale | styleNoLabel );\r\n\r\n\r\nPlotShapes( IIf( Buy, shapeSquare, shapeNone ), colorGreen, 0, L, Offset = -40 );\r\nPlotShapes( IIf( Buy, shapeSquare, shapeNone ), colorLime, 0, L, Offset = -50 );\r\nPlotShapes( IIf( Buy, shapeUpArrow, shapeNone ), colorWhite, 0, L, Offset = -45 );\r\nPlotShapes( Sell * shapeDownArrow, colorRed, 0, H, -75, 0 );\r\nPlotShapes( TSell1 * shapeStar, colorBrightGreen , 0, H, 25, 0 );\r\nPlotShapes( TSell2 * shapeStar, colorBrightGreen , 0, H, 25, 0 );\r\nPlotShapes( SLSell * shapeStar, colorRed , 0, L, -25, 0 );\r\nPlotShapes( TrailSell * shapeStar, colorRed, 0, L, -25, 0 );\r\n\r\n\r\n\r\nAlertIf( Buy, "", "BUY @ " + BuyPrice, 1 );\r\nAlertIf( Sell, "", "SELL @ " + SellPrice, 2 );\r\n\r\n\r\n\r\n\r\n\r\n\r\nGfxSelectFont( "Arial", 9, 100 );\r\nGfxSetBkMode( 1 );\r\nGfxSetTextColor( colorWhite );\r\n\r\nif( SelectedValue( openLong ) == 1 )\r\n{\r\n    GfxSelectSolidBrush( colorDarkGreen );\r\n}\r\nelse\r\n{\r\n    GfxSelectSolidBrush( colorDarkGrey );\r\n}\r\n\r\npxHeight = Status( "pxchartheight" ) ;\r\npxWidth = Status( "pxchartwidth" );\r\n\r\nboxWid = 250;\r\nboxHet = 200;\r\n\r\nx1 = 5;\r\ny1 = pxHeight - boxHet;\r\n\r\nx2 = x1 + boxWid;\r\ny2 = pxHeight;\r\n\r\nsp = 18;\r\nDP = 1.2;\r\n\r\nRelax = !openLong AND !Sell;\r\n\r\nGfxSelectPen( colorBlue, 1 );\r\nGfxRoundRect( x1, y1, x2, y2 , 10, 10 );\r\n\r\nGfxSelectFont( "Arial", 11, 1000 );\r\nGfxTextOut( WriteIf( openLong, "Buy @ " + WriteVal( BuyPrice, DP ), "" ) , 10, y2 - boxHet + sp );\r\nGfxTextOut( WriteIf( Sell, "Sold @ " + WriteVal( SellPrice, DP ), "" ) , 10, y2 - boxHet + 2 * sp );\r\nGfxTextOut( WriteIf( Sell, "Profit @ " + WriteVal( ( SellPrice - BuyPrice ), DP ), "" ) , 10, y2 - boxHet + 4 * sp );\r\nGfxTextOut( WriteIf( Relax, "No Trade Zone - Relax!", "" ), 10, y2 - boxHet + sp );\r\nGfxTextOut( WriteIf( openLong AND !LongTrailPeriod, "Target:" + NumToStr( IIf( openLong AND !LongTrailPeriod, BTPrice1, Null ), DP ), "" ), 10, y2 - boxHet + 3 * sp );\r\nGfxTextOut( WriteIf( openLong , "StopLoss: " + WriteVal( IIf( openLong, BSLPrice , Null ), 1.2 ), "" ), 10, y2 - boxHet + 5 * sp );\r\nGfxTextOut( WriteIf( LongTrailPeriod , "Target:" + NumToStr( IIf( LongTrailPeriod, BTPrice2, Null ), DP ), "" ), 10, y2 - boxHet + 3 * sp );\r\n\r\n\r\n\r\n\r\n_SECTION_BEGIN( "BackTest Settings" );\r\nRoundLotSize = 1;\r\nmaxPos = 10;\r\nTickSize = 0.05;\r\nCAMN = 0.119071; // 0.1% commision per trade + slippage.\r\nINEQ = 500000;//Optimize( "Max INEQ", Max_INEQ, 10000, 30000, 10000 );\r\n_SECTION_END();\r\n\r\nif( Status( "action" ) == actionBacktest )\r\n{\r\n    SetOption( "InitialEquity", INEQ );\r\n    SetOption( "MaxOpenPositions", maxPos );\r\n    SetOption( "AccountMargin", 100 );\r\n    SetOption( "MinShares", 1 );\r\n    SetOption( "PriceBoundChecking", True );\r\n    SetOption( "CommissionMode", 1 ); //1 % FOR PER TRADE\r\n    SetOption( "CommissionAmount", CAMN );\r\n    SetPositionSize( INEQ / maxPos, spsValue ); // number of per trade position value ///INEQ / maxPos, spsValue --( 100, spsPercentOfEquity )\r\n    SetOption( "AllowSameBarExit", False );\r\n    SetOption( "InterestRate", 6 );\r\n    SetBacktestMode( backtestRegular );\r\n}\r\n</Formula>
			<FilePath>C:\\Users\\ksdee\\Documents\\PersonalFinance\\Trading\\Trading\\src\\Strategy1.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741835</MoreFlags>
			<Min>1183.02</Min>
			<Max>1663.79</Max>
		</Pane>
		<Pane>
			<ChartID>1454</ChartID>
			<PercentHeight>20</PercentHeight>
			<Formula>_SECTION_BEGIN("Beta");\r\n\r\nPlot(Aux1,"Delivery" ,colorGreen,styleThick);\r\nPlot(MA(Aux1,5),"5 MA Delivery" ,colorBlue,styleThick);\r\nPlot(MA(Aux1,21),"21 MA Delivery" ,colorRed,styleThick);\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Custom\\del_oi_2.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1342177281</MoreFlags>
			<Min>-128165</Min>
			<Max>1.30679e+007</Max>
		</Pane>
		<Pane>
			<ChartID>1450</ChartID>
			<PercentHeight>20</PercentHeight>
			<Formula>_SECTION_BEGIN("DEL VOL OI");\r\n\r\n\r\nPlot( OI, "OI", colorRed );\r\n\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Custom\\del_vol_oi.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1342177281</MoreFlags>
			<Min>2.7365e+006</Min>
			<Max>4.03809e+006</Max>
		</Pane>
	</Sheet>
	<Sheet>
		<Name>Sheet 5</Name>
		<Pane>
			<ChartID>1527</ChartID>
			<PercentHeight>100</PercentHeight>
			<Formula>\r\n_SECTION_BEGIN( "Price" );\r\nSetChartOptions( 0, chartShowArrows | chartShowDates );\r\n_N( Title = StrFormat( "{{NAME}} - {{INTERVAL}} {{DATE}} Open %g, Hi %g, Lo %g, Close %g (%.1f%%) {{VALUES}}", O, H, L, C, SelectedValue( ROC( C, 1 ) ) ) );\r\nPlot( C, "Close", ParamColor( "Color", colorDefault ), styleNoTitle | ParamStyle( "Style" ) | GetPriceStyle() );\r\n_SECTION_END();\r\n\r\nFilter = Close &gt; 0;\r\n\r\n/* ichioku analysis Start */\r\nConvLine = ( HHV( H, 9 ) + LLV( L, 9 ) ) / 2;\r\nBaseLine = ( HHV( H, 26 ) + LLV( L, 26 ) ) / 2;\r\nLeadSpanA = ( ConvLine + BaseLine ) / 2;\r\nLeadSpanB = ( HHV( H, 52 ) + LLV( L, 52 ) ) / 2;\r\nLagSpan = Ref( C, 26 );\r\n\r\nbuyIchimoku = L &gt; LeadSpanA AND L &gt; LeadSpanB AND Cross( ConvLine , BaseLine );\r\nselIchimoku = Cross( BaseLine , ConvLine );\r\n\r\nprintf( "Ichioku buy =%f sel =%f\\n", buyIchimoku, selIchimoku );\r\n/* ichioku analysis End */\r\n\r\n/* MA slope based analysis Start */\r\nMAS = MA( C, 20 );\r\nMAM = MA( C, 50 );\r\nMAL = MA( C, 100 );\r\n\r\n\r\nTS = LinRegSlope( MAS, 2 ); // TL = Trend Long\r\nTM = LinRegSlope( MAM, 2 ); // TM = Trend Medium\r\nTL = LinRegSlope( MAL, 2 ); // TS = Trend Short\r\n\r\nTLL = IIf( TL &gt; 0, True, False );\r\nTMM = IIf( TM &gt; 0, True, False );\r\nTSS = IIf( TS &gt; 0, True, False );\r\n\r\nbuySlope = MAS &gt; MAM AND MAM &gt; MAL AND TSS &gt; 0 AND Ref( TSS, -1 ) == 1 AND TMM == 1 AND Ref( TMM, -1 ) == 1 AND TLL == 1;\r\nsellSlope = TSS == 0 OR TMM == 0 OR TLL == 0 ;\r\n\r\nprintf( "sellSlope buy =%f sel =%f\\n", buySlope, sellSlope );\r\n/* MA slope based analysis End */\r\n\r\n/* Hammer and Inside day start */\r\nL1 = Ref( L, -1 );\r\nL2 = Ref( L, -2 );\r\nL3 = Ref( L, -3 );\r\nL4 = Ref( L, -4 );\r\nO1 = Ref( O, -1 );\r\nO2 = Ref( O, -2 );\r\nO3 = Ref( O, -3 );\r\nO4 = Ref( O, -4 );\r\nH1 = Ref( H, -1 );\r\nH2 = Ref( H, -2 );\r\nH3 = Ref( H, -3 );\r\nH4 = Ref( H, -4 );\r\nC1 = Ref( C, -1 );\r\nC2 = Ref( C, -2 );\r\nC3 = Ref( C, -3 );\r\nC4 = Ref( C, -4 );\r\n\r\ngreenCandel = C &gt; O ;\r\ndhammertrend = ( L &lt; L1 ) AND( L1 &lt; L2 )AND( L2 &lt; L3 ) AND( L3 &lt; L4 );\r\nuhangingmantrend = ( H &gt; H1 ) AND( H1 &gt; H2 )AND( H2 &gt; H3 ) AND( H3 &gt; H4 );\r\nDoji  = ( abs( O - C ) &lt;= ( ( H - L ) * 0.1 ) );\r\nHammer  = ( ( ( H - L ) &gt; 3 * ( O - C ) ) AND( ( C - L ) / ( .001 + H - L ) &gt; 0.6 ) AND( ( O - L ) / ( .001 + H - L ) &gt; 0.6 ) AND dhammertrend AND NOT Doji );\r\nsmallotherSideWick = IIf( greenCandel, ( ( O - L ) / ( 0.001 + H - L ) &lt; 0.05 ), ( ( H - O ) / ( 0.001 + H - L ) &lt; 0.05 ) );\r\nHammer = Hammer AND smallotherSideWick;\r\n//printf("%f smallotherSideWick %f\\n",greenCandel,smallotherSideWick);\r\nHarami =\r\n    IIf( O &gt; C AND O1 &gt; C1 AND O&lt;O1 AND C&gt;C1, 1,\r\n         IIf( O &gt; C AND C1 &gt; O1 AND C &gt; O1 AND O &lt; C1, 1,\r\n              IIf( C &gt; O AND C1 &gt; O1 AND C&lt;C1 AND O&gt;O1, 1,\r\n                   IIf( C &gt; O AND O1 &gt; C1 AND O &gt; C1 AND C &lt; O1, 1, 0 ) ) ) );\r\n\r\nLongBlackCandle = ( O &gt; C AND( O - C ) / ( .001 + H - L ) &gt; .6 );\r\nLongWhiteCandle  = ( ( C &gt; O ) AND( ( C - O ) / ( .001 + H - L ) &gt; .6 ) );\r\n\r\nBullishHarami = ( Harami AND( O1 &gt; C1 ) AND Ref( LongBlackCandle, -1 ) AND NOT LongWhiteCandle );\r\n\r\ndtrend = ( L1 &lt; L2 )AND( L2 &lt; L3 ) AND( L3 &lt; L4 );\r\nutrend = ( H1 &gt; H2 )AND( H2 &gt; H3 ) AND( H3 &gt; H4 );\r\nBullishEngulfing  = ( LongWhiteCandle AND dtrend  AND( O1 &gt; C1 ) AND( C &gt; O ) AND( C &gt;= O1 ) AND( C1 &gt;= O ) AND( ( C - O ) &gt; ( O1 - C1 ) ) );\r\n\r\nMHT =  HHV( H, 5 ) == H;\r\nBearishHarami = ( ( C1 &gt; O1 ) AND( O &gt; C ) AND( O &lt;= C1 ) AND( O1 &lt;= C ) AND( ( O - C ) &lt; ( C1 - O1 ) ) );\r\nHangingMan  = ( ( ( H - L ) &gt; 4 * ( O - C ) ) AND( ( C - L ) / ( .001 + H - L ) &gt;= 0.75 ) AND( ( O - L ) / ( .001 + H - L ) &gt;= 0.75 ) AND uhangingmantrend AND NOT Doji );\r\nBearishEngulfing  = ( MHT AND utrend  AND LongBlackCandle AND( C1 &gt; O1 ) AND( O &gt; C ) AND( O &gt;= C1 ) AND( O1 &gt;= C ) AND( ( O - C ) &gt; ( C1 - O1 ) ) );\r\n\r\nstoD = StochD( 4, 1, 1 );\r\ncandlStocBuy = stoD &gt; 20 AND Hammer OR BullishHarami OR BullishEngulfing;\r\ncandlStocSell = stoD &lt; 80 AND HangingMan OR BearishHarami OR BearishEngulfing;\r\n\r\nprintf( "candel buy =%f sel =%f\\n", candlStocBuy, candlStocSell );\r\n/* Hammer and Inside day  */\r\n/* macd with uptrend using EMA 5,21,200 */\r\nweekly_ma = EMA( C, 5 );\r\nmonthly_ma = EMA( C, 21 );\r\nyearly_ma = EMA( C, 200 );\r\n\r\nPlot( weekly_ma, "5 day EMA", colorYellow, styleDashed );\r\nPlot( monthly_ma, "21 day EMA", colorBlue, styleDashed );\r\nPlot( yearly_ma, "200 day EMA", colorBlueGrey, styleDashed );\r\n\r\ndaily_uptrend = weekly_ma &gt; monthly_ma AND monthly_ma  &gt; yearly_ma;\r\ndaily_downtrend = NOT daily_uptrend;\r\n\r\nind_macd = MACD( 13, 21 );\r\nsig_macd = Signal( 13, 21, 9 );\r\n\r\nmacdBuy =  Cross( ind_macd, sig_macd );\r\nmacdSell = Cross( sig_macd, ind_macd );\r\n\r\nprintf( "MACD buy =%f sel =%f\\n", macdBuy, macdSell );\r\n/* macd with uptrend using EMA 5,21,200 */\r\n/*bb strategy start*/\r\nbbtop2 = BBandTop( C, 13, 2 );\r\nbbBtm2 = BBandBot( C, 13, 2 );\r\nbbtop1 = BBandTop( C, 13, 1 );\r\nbbBtm1 = BBandBot( C, 13, 1 );\r\nind_rsi = RSI( 13 );\r\n//bbTopBuySignal = ( C &gt; bbtop1 AND H &lt; bbtop2 );\r\n//bbTopBuySignal = bbTopBuySignal AND Ref( C, -1 ) &gt; Ref( bbtop1, -1 ) AND Ref( H, -1 ) &lt; Ref( bbtop2, -1 );\r\n//bbTopBuySignal = bbTopBuySignal AND Ref( C, -2 ) &gt; Ref( bbtop1, -2 ) AND Ref( H, -2 ) &lt; Ref( bbtop2, -2 );\r\nbbBuy =  L &lt; bbBtm2 AND ind_rsi &lt; 30;\r\nbbSell = H &gt; bbtop2 AND ind_rsi &gt; 70;\r\nprintf( "BB Band buy =%f sel =%f\\n", bbBuy, bbSell );\r\n/*bb strategy end*/\r\n/*cci strategy*/\r\nshrt_cci = CCI( 21 );\r\nTimeFrameSet( inWeekly );\r\nlng_cci = CCI( 13 );\r\nTimeFrameRestore();\r\n\r\nbuyCCI = lng_cci &gt; -100 AND Cross( shrt_cci , -100 ) \t;\r\nsellCCI = lng_cci &gt; 100 OR shrt_cci &gt; 100;\r\n\r\nprintf( "CCI buy =%f sel =%f\\n", buyCCI, sellCCI );\r\n/*cci strategy end*/\r\n/*super trend */\r\nFactor = 8;\r\nPd = 13;\r\n\r\nUp = ( H + L ) / 2 + ( Factor*ATR( Pd ) );\r\nDn = ( H + L ) / 2 - ( Factor*ATR( Pd ) );\r\niATR = ATR( Pd );\r\nTrendUp = TrendDown = Null;\r\ntrend[0] = 1;\r\nchangeOfTrend = 0;\r\nflag = flagh = 0;\r\n\r\nfor( i = 1; i &lt; BarCount - 1; i++ )\r\n{\r\n    TrendUp[i] = Null;\r\n    TrendDown[i] = Null;\r\n\r\n    trend[i] = 1;\r\n\r\n\r\n    if( Close[i] &gt; Up[i - 1] )\r\n    {\r\n        trend[i] = 1;\r\n\r\n        if( trend[i - 1] == -1 ) changeOfTrend = 1;\r\n\r\n    }\r\n    else\r\n        if( Close[i] &lt; Dn[i - 1] )\r\n        {\r\n            trend[i] = -1;\r\n\r\n            if( trend[i - 1] == 1 ) changeOfTrend = 1;\r\n        }\r\n        else\r\n            if( trend[i - 1] == 1 )\r\n            {\r\n                trend[i] = 1;\r\n                changeOfTrend = 0;\r\n            }\r\n            else\r\n                if( trend[i - 1] == -1 )\r\n                {\r\n                    trend[i] = -1;\r\n                    changeOfTrend = 0;\r\n                }\r\n\r\n    if( trend[i] &lt; 0 &amp;&amp; trend[i - 1] &gt; 0 )\r\n    {\r\n        flag = 1;\r\n    }\r\n    else\r\n    {\r\n        flag = 0;\r\n    }\r\n\r\n    if( trend[i] &gt; 0 &amp;&amp; trend[i - 1] &lt; 0 )\r\n    {\r\n        flagh = 1;\r\n    }\r\n    else\r\n    {\r\n        flagh = 0;\r\n    }\r\n\r\n    if( trend[i] &gt; 0 &amp;&amp; Dn[i] &lt; Dn[i - 1] )\r\n    {\r\n        Dn[i] = Dn[i - 1];\r\n    }\r\n\r\n    if( trend[i] &lt; 0 &amp;&amp; Up[i] &gt; Up[i - 1] )\r\n    {\r\n        Up[i] = Up[i - 1];\r\n    }\r\n\r\n    if( flag == 1 )\r\n    {\r\n        Up[i] = ( H[i] + L[i] ) / 2 + ( Factor * iATR[i] );;\r\n    }\r\n\r\n    if( flagh == 1 )\r\n    {\r\n        Dn[i] = ( H[i] + L[i] ) / 2 - ( Factor * iATR[i] );;\r\n    }\r\n\r\n    if( trend[i] == 1 )\r\n    {\r\n        TrendUp[i] = Dn[i];\r\n\r\n        if( changeOfTrend == 1 )\r\n        {\r\n            TrendUp[i - 1] = TrendDown[i - 1];\r\n            changeOfTrend = 0;\r\n        }\r\n    }\r\n    else\r\n        if( trend[i] == -1 )\r\n        {\r\n            TrendDown[i] = Up[i];\r\n\r\n            if( changeOfTrend == 1 )\r\n            {\r\n                TrendDown[i - 1] = TrendUp[i - 1];\r\n                changeOfTrend = 0;\r\n            }\r\n        }\r\n}\r\n\r\nPlot( TrendUp, "Trend", colorGreen );\r\nPlot( TrendDown, "Down", colorRed );\r\nsuperTrendBuy = trend==1;\r\nsuperTrendSell = trend==-1;\r\nprintf( "super trend buy =%f sel =%f\\n", superTrendBuy, superTrendSell );\r\n/*super trend end*/\r\n/*delivery volume*/\r\ndelVol_ma_shrt = MA( Aux1, 5 );\r\ndelVol_ma_long = MA( Aux1, 21 );\r\ndelVol_check = Aux1 &gt; delVol_ma_shrt AND delVol_ma_shrt &gt; delVol_ma_long;\r\n/*delivery volume ends*/\r\n/*open interest check*/\r\ncheck_OI = OI &gt; Ref( OI, -1 ) AND Ref( OI, -1 ) &gt; Ref( OI, -2 );\r\n/*open interest check end*/\r\nttlBuy = bbBuy + macdBuy + candlStocBuy + buySlope + buyIchimoku + buyCCI +superTrendBuy;\r\nttlSel = bbSell + macdSell + candlStocSell + sellSlope + selIchimoku + sellCCI +superTrendSell;\r\n\r\n\r\n\r\nAddColumn( ttlBuy, "Buy Strength", 1.2, colorBlack, IIf(ttlBuy&gt;=3,colorGreen,IIf(ttlBuy==2 ,ColorRGB(144,238,144),IIf(ttlBuy==1,ColorRGB(173,255,47),colorLightGrey))), width = 100 );\r\nAddColumn( ttlSel, "Sel Strength", 1.2, colorBlack, colorLightGrey, width = 100 );\r\n\r\nAddColumn( delVol_check, "Delevery Check", 1.2, colorBlack, IIf(delVol_check,colorGreen,colorLightGrey), width = 100 );\r\nAddColumn( check_OI, "OI Check", 1.2, colorBlack, IIf(check_OI,colorGreen,colorLightGrey), width = 100 );\r\n\r\nAddColumn( buyIchimoku, "Buy Ichimoku", 1.2, colorBlack, IIf(buyIchimoku,colorGreen,colorLightGrey), width = 100 );\r\nAddColumn( selIchimoku, "Sel Ichimoku", 1.2, colorBlack, colorLightGrey, width = 100 );\r\n\r\nAddColumn( candlStocBuy, "Buy Sto Bull candel", 1.2, colorBlack, IIf(candlStocBuy,colorGreen,colorLightGrey), width = 100 );\r\nAddColumn( candlStocSell, "Sel Sto Bull candel", 1.2, colorBlack, colorLightGrey, width = 100 );\r\n\r\nAddColumn( bbBuy, "Buy BB Band", 1.2, colorBlack, IIf(bbBuy,colorGreen,colorLightGrey), width = 100 );\r\nAddColumn( bbSell, "Sel BB Band", 1.2, colorBlack, colorLightGrey, width = 100 );\r\n\r\nAddColumn( macdBuy, "Buy MACD", 1.2, colorBlack, IIf(macdBuy,colorGreen,colorLightGrey), width = 100 );\r\nAddColumn( macdSell, "Sel MACD", 1.2, colorBlack, colorLightGrey, width = 100 );\r\n\r\nAddColumn( buyCCI, "Buy CCI", 1.2, colorBlack, IIf(buyCCI,colorGreen,colorLightGrey), width = 100 );\r\nAddColumn( sellCCI, "Sel CCI", 1.2, colorBlack, colorLightGrey, width = 100 );\r\n\r\nAddColumn( superTrendBuy, "Buy superTrend", 1.2, colorBlack, IIf(superTrendBuy,colorGreen,colorLightGrey), width = 100 );\r\nAddColumn( superTrendSell, "Sel superTrend", 1.2, colorBlack, colorLightGrey, width = 100 );\r\n\r\nAddColumn( buySlope, "Buy slope", 1.2, colorBlack, IIf(buySlope,colorGreen,colorLightGrey), width = 100 );\r\nAddColumn( sellSlope, "Sel slope", 1.2, colorBlack, colorLightGrey, width = 100 );\r\n\r\n_SECTION_BEGIN( "Price1" );\r\nSetChartOptions( 0, chartShowArrows | chartShowDates );\r\n_N( Title = StrFormat( "{{NAME}} - {{INTERVAL}} {{DATE}} Open %g, Hi %g, Lo %g, Close %g (%.1f%%) {{VALUES}}", O, H, L, C, SelectedValue( ROC( C, 1 ) ) ) );\r\nPlot( C, "Close", ParamColor( "Color", colorDefault ), styleNoTitle | ParamStyle( "Style" ) | GetPriceStyle() );\r\n_SECTION_END();\r\n\r\n\r\nPositionScore = ttlBuy - ttlSel;\r\n\r\nBuy = Ref( candlStocBuy, -1 ) and Ref( bbBuy, -1 )AND Ref( delVol_check, -1 ) AND Ref( C, -1 ) &gt;= L AND Ref( C, -1 ) &lt;= H; //AND Ref( check_OI, -1 ) &gt; Ref( ttlSel, -1 )\r\n\r\nSell = candlStocSell and bbSell;//ttlSel  &gt; ttlBuy\r\n\r\n\r\nCover = Short = 0;\r\n\r\nBuy = ExRem( Buy, Sell );\r\nSell = ExRem( Sell, Buy );\r\n\r\nopenlong = Flip( Buy, Sell );\r\n\r\nBuyPrice = ValueWhen( Buy, C ) ;\r\nSellPrice = ValueWhen( Sell, C ) ;\r\n\r\nTG1 = 5;\r\nTG2 = 10;\r\nSL = 5;\r\nTSLP = 50;\r\nMinSpread =  0.05;\r\nBTP1 = ( round( BuyPrice * ( 1 + TG1 / 100 ) / MinSpread ) * MinSpread );\r\nBTP2 = ( round( BuyPrice * ( 1 + TG2 / 100 ) / MinSpread ) * MinSpread );\r\nBTPrice1 = IIf( openlong OR Sell, BTP1, Null );\r\nBTPrice2 = IIf( openlong OR Sell, BTP2, Null );\r\n\r\nBSLP = ( round( BuyPrice * ( 1 - SL / 100 ) / MinSpread ) * MinSpread );\r\nBSLPrice = IIf( openlong OR Sell, BSLP, Null );\r\n\r\nTSell1 = ( H &gt;= BTPrice1 ) AND !Buy AND !IsNull( BTPrice1 );\r\nTSell2 = ( H &gt;= BTPrice2 ) AND !Buy AND !IsNull( BTPrice2 );\r\nSLSell = ( L &lt;= BSLPrice AND !Buy ) AND !IsNull( BSLPrice );\r\n\r\nSell = ( Sell OR TSell2 ) OR SLSell;\r\n\r\nBuy = ExRem( Buy, Sell );\r\nSell = ExRem( Sell, Buy );\r\nOpenLong = Flip( Buy, Sell );\r\n\r\n\r\nTSell1 = ( OpenLong ) AND TSell1;\r\nTSell2 = ( OpenLong OR Sell ) AND TSell2;\r\nSLSell = ( OpenLong OR Sell ) AND SLSell;\r\n\r\nTSell1 = ExRem( TSell1, Sell );\r\nTSell2 = ExRem( TSell2, Sell );\r\nSLSell = ExRem( SLSell, Sell );\r\n\r\n\r\nBuyPrice = IIf( OpenLong OR Sell, BuyPrice, Null );\r\nBTPrice1 = IIf( OpenLong OR Sell, BTPrice1, Null );\r\nBTPrice2 = IIf( OpenLong OR Sell, BTPrice2, Null );\r\nBSLPrice = IIf( OpenLong OR Sell, BSLPrice, Null );\r\n\r\n\r\nLongTrailPeriod = Flip( Ref( TSell1, -1 ), Sell ); //start from Tsell1 and finish at sell.\r\n\r\n\r\nfunction LongTrailPrice( Trigger, TSLP )\r\n{\r\n    return HighestSince( Trigger, HighestSince( Trigger, Ref( H, -1 ), 1 ) - TSLP, 1 );\r\n}\r\n\r\nLTSLV = round( ( TSLP * ( BTPrice1 - BuyPrice ) / 100 ) / MinSpread ) * MinSpread;\r\n\r\nLongTrailPr = IIf( OpenLong AND LongTrailPeriod, LongTrailPrice( Ref( TSell1, -1 ), LTSLV ), Null );\r\nLongTrailPr = IIf( LongTrailPr == BTPrice1, LongTrailPr - MinSpread, LongTrailPr );\r\n\r\nTrailSell = IIf( IsNull( LongTrailPr ), 0, ( L &lt;= LongTrailPr ) );\r\n\r\nSell = Sell OR TrailSell;\r\nBuy = ExRem( Buy, Sell );\r\nSell = ExRem( Sell, Buy );\r\nCover = ExRem( Cover, Short );\r\n\r\nOpenLong = Flip( Buy, Sell );\r\n\r\nTSell1 = ( OpenLong ) AND TSell1;\r\nTSell2 = ( OpenLong OR Sell ) AND TSell2;\r\nSLSell = ( OpenLong OR Sell ) AND SLSell;\r\nTrailSell = ( OpenLong OR Sell ) AND TrailSell;\r\n\r\nTSell1 = ExRem( TSell1, Sell );\r\nTSell2 = ExRem( TSell2, Sell );\r\nSLSell = ExRem( SLSell, Sell );\r\n\r\n\r\nTrailSell = ExRem( TrailSell, Sell );\r\n\r\nLongTrailPeriod = Flip( TSell1, Sell );\r\n\r\nBuyPrice = IIf( OpenLong OR Sell, BuyPrice, Null );\r\nBTPrice1 = IIf( OpenLong OR Sell, BTPrice1, Null );\r\nBTPrice2 = IIf( OpenLong OR Sell, BTPrice2, Null );\r\nBSLPrice = IIf( OpenLong OR Sell, BSLPrice, Null );\r\nLongTrailPr = IIf( LongTrailPeriod OR TrailSell, LongTrailPr, Null );\r\nSellPrice = IIf( Sell*SLSell, BSLPrice, IIf( Sell*TSell1, BTPrice1, IIf( Sell*TSell2, BTPrice2, IIf( Sell*TrailSell, LongTrailPr, IIf( Sell, Close, Null ) ) ) ) );\r\n\r\n\r\n\r\nPlot( BuyPrice, "Buy Price", colorBrightGreen, styleLine | styleThick | styleNoLabel | styleNoRescale | styleNoTitle );\r\nPlot( BTPrice1, "Buy Target Price1", colorGreen, styleLine | styleDashed | styleNoTitle | styleNoRescale );\r\nPlot( BTPrice2, "Buy Target Price2", colorGreen, styleLine | styleDashed | styleNoTitle | styleNoRescale );\r\nPlot( BSLPrice, "Buy SL Price", colorRed, styleLine | styleDashed | styleNoTitle | styleNoRescale );\r\nPlot( LongTrailPr, "Long Trail Price", colorBrightGreen , styleStaircase | styleThick | styleNoTitle | styleNoRescale | styleNoLabel );\r\n\r\n\r\nPlotShapes( IIf( Buy, shapeSquare, shapeNone ), colorGreen, 0, L, Offset = -40 );\r\nPlotShapes( IIf( Buy, shapeSquare, shapeNone ), colorLime, 0, L, Offset = -50 );\r\nPlotShapes( IIf( Buy, shapeUpArrow, shapeNone ), colorWhite, 0, L, Offset = -45 );\r\nPlotShapes( Sell * shapeDownArrow, colorRed, 0, H, -75, 0 );\r\nPlotShapes( TSell1 * shapeStar, colorBrightGreen , 0, H, 25, 0 );\r\nPlotShapes( TSell2 * shapeStar, colorBrightGreen , 0, H, 25, 0 );\r\nPlotShapes( SLSell * shapeStar, colorRed , 0, L, -25, 0 );\r\nPlotShapes( TrailSell * shapeStar, colorRed, 0, L, -25, 0 );\r\n\r\n\r\n\r\nAlertIf( Buy, "", "BUY @ " + BuyPrice, 1 );\r\nAlertIf( Sell, "", "SELL @ " + SellPrice, 2 );\r\n\r\n\r\n\r\n\r\n\r\n\r\nGfxSelectFont( "Arial", 9, 100 );\r\nGfxSetBkMode( 1 );\r\nGfxSetTextColor( colorWhite );\r\n\r\nif( SelectedValue( openLong ) == 1 )\r\n{\r\n    GfxSelectSolidBrush( colorDarkGreen );\r\n}\r\nelse\r\n{\r\n    GfxSelectSolidBrush( colorDarkGrey );\r\n}\r\n\r\npxHeight = Status( "pxchartheight" ) ;\r\npxWidth = Status( "pxchartwidth" );\r\n\r\nboxWid = 250;\r\nboxHet = 200;\r\n\r\nx1 = 5;\r\ny1 = pxHeight - boxHet;\r\n\r\nx2 = x1 + boxWid;\r\ny2 = pxHeight;\r\n\r\nsp = 18;\r\nDP = 1.2;\r\n\r\nRelax = !openLong AND !Sell;\r\n\r\nGfxSelectPen( colorBlue, 1 );\r\nGfxRoundRect( x1, y1, x2, y2 , 10, 10 );\r\n\r\nGfxSelectFont( "Arial", 11, 1000 );\r\nGfxTextOut( WriteIf( openLong, "Buy @ " + WriteVal( BuyPrice, DP ), "" ) , 10, y2 - boxHet + sp );\r\nGfxTextOut( WriteIf( Sell, "Sold @ " + WriteVal( SellPrice, DP ), "" ) , 10, y2 - boxHet + 2 * sp );\r\nGfxTextOut( WriteIf( Sell, "Profit @ " + WriteVal( ( SellPrice - BuyPrice ), DP ), "" ) , 10, y2 - boxHet + 4 * sp );\r\nGfxTextOut( WriteIf( Relax, "No Trade Zone - Relax!", "" ), 10, y2 - boxHet + sp );\r\nGfxTextOut( WriteIf( openLong AND !LongTrailPeriod, "Target:" + NumToStr( IIf( openLong AND !LongTrailPeriod, BTPrice1, Null ), DP ), "" ), 10, y2 - boxHet + 3 * sp );\r\nGfxTextOut( WriteIf( openLong , "StopLoss: " + WriteVal( IIf( openLong, BSLPrice , Null ), 1.2 ), "" ), 10, y2 - boxHet + 5 * sp );\r\nGfxTextOut( WriteIf( LongTrailPeriod , "Target:" + NumToStr( IIf( LongTrailPeriod, BTPrice2, Null ), DP ), "" ), 10, y2 - boxHet + 3 * sp );\r\n\r\n\r\n\r\n\r\n_SECTION_BEGIN( "BackTest Settings" );\r\nRoundLotSize = 1;\r\nmaxPos = 10;\r\nTickSize = 0.05;\r\nCAMN = 0.119071; // 0.1% commision per trade + slippage.\r\nINEQ = 500000;//Optimize( "Max INEQ", Max_INEQ, 10000, 30000, 10000 );\r\n_SECTION_END();\r\n\r\nif( Status( "action" ) == actionBacktest )\r\n{\r\n    SetOption( "InitialEquity", INEQ );\r\n    SetOption( "MaxOpenPositions", maxPos );\r\n    SetOption( "AccountMargin", 100 );\r\n    SetOption( "MinShares", 1 );\r\n    SetOption( "PriceBoundChecking", True );\r\n    SetOption( "CommissionMode", 1 ); //1 % FOR PER TRADE\r\n    SetOption( "CommissionAmount", CAMN );\r\n    SetPositionSize( INEQ / maxPos, spsValue ); // number of per trade position value ///INEQ / maxPos, spsValue --( 100, spsPercentOfEquity )\r\n    SetOption( "AllowSameBarExit", False );\r\n    SetOption( "InterestRate", 6 );\r\n    SetBacktestMode( backtestRegular );\r\n}\r\n</Formula>
			<FilePath>C:\\Users\\ksdee\\Documents\\PersonalFinance\\Trading\\Trading\\src\\Strategy1.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1073741835</MoreFlags>
			<Min>391.839</Min>
			<Max>634.603</Max>
		</Pane>
	</Sheet>
	<Sheet>
		<Name>Sheet 6</Name>
		<Pane>
			<ChartID>0</ChartID>
			<PercentHeight>50</PercentHeight>
		</Pane>
	</Sheet>
	<Sheet>
		<Name>Sheet 7</Name>
		<Pane>
			<ChartID>0</ChartID>
			<PercentHeight>50</PercentHeight>
		</Pane>
	</Sheet>
	<Sheet>
		<Name>Sheet 8</Name>
		<Pane>
			<ChartID>0</ChartID>
			<PercentHeight>50</PercentHeight>
		</Pane>
	</Sheet>
</Window>
